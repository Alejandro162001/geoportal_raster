<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa con Cambiador de Capas Base y Previews Bonitos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.4.0/ol.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/ol@v7.4.0/dist/ol.js"></script>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <!-- Contenedor del mapa -->
    <div id="map"></div>

    <!-- Selector con preview de capas base -->
    <div class="layer-switcher">
        <div class="layer-option active" data-layer="osm">
            <img src="https://a.tile.openstreetmap.org/4/2/3.png" alt="OpenStreetMap">
            <span>OpenStreetMap</span>
        </div>
        <div class="layer-option" data-layer="esri">
            <img src="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/4/2/3" alt="Esri Satellite">
            <span>Satellite</span>
        </div>
        <div class="layer-option" data-layer="cartodb">
            <img src="https://cartodb-basemaps-a.global.ssl.fastly.net/rastertiles/voyager/4/2/3.png" alt="CartoDB">
            <span>Carto</span>
        </div>
    </div>

    <script>
        // Crear capas base
        const osmLayer = new ol.layer.Tile({
            source: new ol.source.OSM(),
            visible: true, // Visible por defecto
            title: 'osm'
        });

        const esriLayer = new ol.layer.Tile({
            source: new ol.source.XYZ({
                url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
            }),
            visible: false,
            title: 'esri'
        });

        const cartoLayer = new ol.layer.Tile({
            source: new ol.source.XYZ({
                url: 'https://{1-4}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png'
            }),
            visible: false,
            title: 'cartodb'
        });

        // Crear el mapa y agregar las capas
        const map = new ol.Map({
            target: 'map',
            layers: [osmLayer, esriLayer, cartoLayer], // Añadir todas las capas
            view: new ol.View({
                center: ol.proj.fromLonLat([-98.35, 39.50]), // Centro en EE.UU.
                zoom: 4
            })
        });

        // Función para cambiar entre capas base
        const options = document.querySelectorAll('.layer-option');
        options.forEach(option => {
            option.addEventListener('click', function() {
                const selectedLayer = this.getAttribute('data-layer');
                
                // Iterar sobre las capas del mapa y ajustar la visibilidad
                map.getLayers().forEach(function(layer) {
                    const title = layer.get('title');
                    layer.setVisible(title === selectedLayer);
                });
                
                // Actualizar el estilo activo en la lista de opciones
                options.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>